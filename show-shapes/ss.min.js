/*! 2013-11-01 */
(function(){function e(e,t,i){t||(t=0),i||(i=0),this.elem=e,this.style=getComputedStyle(e),this.unitsMap=this.generateUnitsMap(),this.bounds=this.generateBounds(t,i),this.shapeInside=this.parseShape(this.getShapeInside()),this.shapeOutside=this.parseShape(this.getShapeOutside())}function t(e,t){return e.reduce(function(e,i){return e||t[i]},null)}function i(e,t,i){return e.reduce(function(e,n){return e||(t[n]=i)},null)}function n(e){return function(){return t(e,this.style)}}function o(e){return function(t){return i(e,this.elem.style,t)}}function s(e,t,i,n,o,s,r,l){if(e.beginPath(),r&&l){var h=.5522848,a=r*h,c=l*h;e.moveTo(i+r,n),e.lineTo(i+o-r,n),e.bezierCurveTo(i+o-r+a,n,i+o,n+l-c,i+o,n+l),e.lineTo(i+o,n+s-l),e.bezierCurveTo(i+o,n+s-l+c,i+o-r+a,n+s,i+o-r,n+s),e.lineTo(i+r,n+s),e.bezierCurveTo(i+r-a,n+s,i,n+s-l+c,i,n+s-l),e.lineTo(i,n+l),e.bezierCurveTo(i,n+l-c,i+r-a,n,i+r,n)}else e.moveTo(i,n),e.lineTo(i+o,n),e.lineTo(i+o,n+s),e.lineTo(i,n+s);e.closePath(),e.fillStyle=t,e.fill()}function r(e,t,i,n,o){e.beginPath(),e.arc(i,n,o,0,2*Math.PI),e.closePath(),e.fillStyle=t,e.fill()}function l(e,t,i,n,o,s){var r=.5522848,l=o*r,h=s*r;e.beginPath(),e.moveTo(i,n-s),e.bezierCurveTo(i+l,n-s,i+o,n-h,i+o,n),e.bezierCurveTo(i+o,n+h,i+l,n+s,i,n+s),e.bezierCurveTo(i-l,n+s,i-o,n+h,i-o,n),e.bezierCurveTo(i-o,n-h,i-l,n-s,i,n-s),e.closePath(),e.fillStyle=t,e.fill()}function h(e,t,i){e.beginPath(),i.forEach(function(t,i){i?e.lineTo(t.x,t.y):e.moveTo(t.x,t.y)}),e.closePath(),e.fillStyle=t,e.fill()}function a(e,t,i,n){var o;switch(i.shape){case"rectangle":s(e,n,t.x+i.x,t.y+i.y,i.width,i.height,i.rx,i.ry);break;case"circle":r(e,n,t.x+i.cx,t.y+i.cy,i.r);break;case"ellipse":l(e,n,t.x+i.cx,t.y+i.cy,i.rx,i.ry);break;case"polygon":o=i.points.map(function(e){return{x:e.x+t.x,y:e.y+t.y}}),h(e,n,o);break;default:s(e,n,t.x,t.y,t.width,t.height,0,0)}}function c(e,t){var i=t.shapeInside,n=t.shapeOutside,o=t.bounds;n&&a(e,o,n,"#1e90ff"),i&&a(e,o,i,"#43cd80")}function u(){var e=document.getElementById("show-shapes-canvas");e.width=document.documentElement.offsetWidth,e.height=document.documentElement.offsetHeight;var t=e.getContext("2d");t.fillRect(0,0,e.width,e.height,"rgba(0, 0, 0, 0.2)"),y.forEach(function(t){c(e.getContext("2d"),t)})}function d(){T?g():m(),T=!T}function p(e,t){for(var i in t)e.style[i]=t[i]}function f(t,i,n){for(var o=[],s=t.getElementsByTagName("*"),r=0;s.length>r;r++){var l=s[r];e.hasShapes(l)&&o.push(new e(l,i,n))}return o}function m(){var e=document.createElement("div");e.id="show-shapes-overlay";var t={position:"absolute",top:"0",left:"0",zIndex:"1040"};p(e,t);var i=document.createElement("button");i.innerHTML="close",t={position:"fixed",top:"1em",right:"1em",background:"#1e90ff",border:"0",padding:"0.5em",color:"white",fontSize:"1.2em",borderRadius:"0.5em"},p(i,t),i.onclick=d;var n=document.createElement("canvas");n.id="show-shapes-canvas";var t={opacity:"0.7"};p(n,t),e.appendChild(n),e.appendChild(i),document.body.appendChild(e),y=[],y=y.concat(f(document,window.pageXOffset,window.pageYOffset));for(var o,s,r=document.querySelectorAll("iframe"),l=0;r.length>l;l++)o=r[l],s=o.getBoundingClientRect(),y=y.concat(f(o.contentDocument,s.left+window.pageXOffset+o.clientLeft,s.top+window.pageYOffset+o.clientTop));window.addEventListener("resize",u,!1),u()}function g(){window.removeEventListener("resize",u);var e=document.getElementById("show-shapes-overlay");document.body.removeChild(e),y=[]}var v=["shapeInside","webkitShapeInside"],x=["shapeOutside","webkitShapeOutside"];e.hasShapes=function(e){var i=getComputedStyle(e);if(!i)return!1;var n=t(v,i),o=t(x,i);return n&&n.indexOf("(")>0||o&&o.indexOf("(")>0},e.prototype.getShapeInside=n(v),e.prototype.setShapeInside=o(v),e.prototype.getShapeOutside=n(x),e.prototype.setShapeOutside=o(x),e.prototype.generateUnitsMap=function(){var e=["em","ex","ch","rem","vw","vh","vmin","vmax","cm","mm","in","px","pt","pc"],t=document.createElement("div");this.elem.appendChild(t);var i=getComputedStyle(t),n={};return e.forEach(function(e){t.style.fontSize="1"+e,n[e]=parseFloat(i.fontSize)}),this.elem.removeChild(t),n},e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e.prototype.toPixels=function(t,i){i===void 0&&(i=e.HORIZONTAL);var n;n=i===e.HORIZONTAL?this.bounds.width:i===e.VERTICAL?this.bounds.height:i;var o,s,r=/([\-0-9\.]*)([a-z%]*)/.exec(t);return o=parseFloat(r[1]),s=r[2],"%"===s?o*n/100:o*this.unitsMap[s]},e.prototype.generateBounds=function(e,t){var i=this.elem.getBoundingClientRect(),i={x:i.left+e,y:i.top+t,width:i.width,height:i.height};if("border-box"===this.style.boxSizing)return i;var n=this.elem.clientLeft,o=this.elem.clientTop;return i.x+=n,i.y+=o,i.width=this.elem.clientWidth,i.height=this.elem.clientHeight,i},e.prototype.parseShape=function(t){if(t=t.split(/[()]/),!(1>=t.length)){var i=t[0],n=t[1].split(",");n=n.map(function(e){return e.trim(0)});var o,s=this;switch(i){case"rectangle":o={shape:"rectangle",x:this.toPixels(n[0],e.HORIZONTAL),y:this.toPixels(n[1],e.VERTICAL),width:this.toPixels(n[2],e.HORIZONTAL),height:this.toPixels(n[3],e.VERTICAL),rx:5>n.length?0:this.toPixels(n[4],e.HORIZONTAL),ry:6>n.length?o.rx:this.toPixels(n[5],e.VERTICAL),bounds:this.bounds,element:this.elem};break;case"inset-rectangle":o={shape:"inset-rectangle",top:this.toPixels(n[0],e.VERTICAL),right:this.toPixels(n[1],e.HORIZONTAL),bottom:this.toPixels(n[2],e.VERTICAL),left:this.toPixels(n[3],e.HORIZONTAL),rx:5>n.length?0:this.toPixels(n[4],e.HORIZONTAL),ry:6>n.length?o.rx:this.toPixels(n[5],e.VERTICAL),bounds:this.bounds,element:this.elem};break;case"circle":o={shape:"circle",cx:this.toPixels(n[0],e.HORIZONTAL),cy:this.toPixels(n[1],e.VERTICAL),r:this.toPixels(n[2],Math.sqrt((e.HORIZONTAL*e.HORIZONTAL+e.VERTICAL*e.VERTICAL)/2)),bounds:this.bounds,element:this.elem};break;case"ellipse":o={shape:"ellipse",cx:this.toPixels(n[0],e.HORIZONTAL),cy:this.toPixels(n[1],e.VERTICAL),rx:this.toPixels(n[2],e.HORIZONTAL),ry:this.toPixels(n[3],e.VERTICAL),bounds:this.bounds,element:this.elem};break;case"polygon":o={shape:"polygon",fillRule:n[0].search(/nonzero|evenodd/i)>=0?n.shift():"nonzero",points:n.map(function(t){return t=t.split(/\s+/),{x:s.toPixels(t[0],e.HORIZONTAL),y:s.toPixels(t[1],e.VERTICAL)}}),bounds:this.bounds,element:this.elem};break;case"url":o={shape:"image",url:n[0],bounds:this.bounds,element:this.elem};break;default:o=null}return o}};var y=[],T=!1;window.ShowShapes={toggleOverlay:d,ShapeInfo:e}})();