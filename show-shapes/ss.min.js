/*! 2013-02-28 */
(function(){function e(){var e=arguments;return e[0].replace(/{(\d+)}/g,function(t,r){var a=parseInt(r);return a>=0&&e.length-1>a?e[a+1]:""})}function t(t,r){t=t.split(/[()]/);var a,o=t[0],i="";switch(t.length>1&&(a=t[1].split(/\s*,\s*/)),o){case"rectangle":var n="",l="";a.length>4&&(n="rx='"+a[4]+"'",l="ry='"+(a.length>5?a[5]:a[4])+"'"),i=e("<rect x='{0}' y='{1}' width='{2}' height='{3}' {4} {5} />",a[0],a[1],a[2],a[3],n,l);break;case"circle":i=e("<circle cx='{0}' cy='{1}' r='{2} />",a[0],a[1],a[2]);break;case"ellipse":i=e("<ellipse cx='{0}' cy='{1}' rx='{2}' ry='{3}' />",a[0],a[1],a[2],a[3]);break;case"polygon":var s=a[0].search(/nonzero|evenodd/i)>=0?a.shift():"nonzero",c=a.map(function(e){return e=e.replace(/\s+/,","),e=e.replace(/(-?\d+(?:\.\d+)?)(px|%)/g,function(e,t,a,o){var i=parseFloat(t);switch(a){case"%":i*=(o?r.offsetHeight:r.offsetWidth)/100;case"px":default:}return""+i})});c=c.join(" "),i=e("<polygon fill-rule='{0}' points='{1}' />",s,c);break;default:return null}return"<svg xmlns='http://www.w3.org/2000/svg' style='display:block' width='100%' height='100%'><g fill='blue'>"+i+"</g></svg>"}function r(e,r,a){var o=t(a,e,r);if(o){"static"==r.getPropertyValue("position")&&e.style.setProperty("position","relative");var i=document.createElement("div");i.setAttribute("class","shape-bookmarklet-overlay"),i.setAttribute("style","width:100%;height:100%;position:absolute;top:0;left:0;opacity:0.5"),i.innerHTML=o,e.appendChild(i)}}function a(t,r){t=t.split(/[()]/);var a,o,i,n,l=t[0],s=t[1].split(/\s*,\s*/),c="";switch(l){case"rectangle":var p="",h="";s.length>4&&(p="rx='"+s[4]+"'",h="ry='"+(s.length>5?s[5]:s[4])+"'"),a=s[0],o=s[1],i=s[2],n=s[3],c=e("<rect x='0' y='0' width='100%' height='100%' {1} {2} />",p,h);break;case"circle":var u=s[0].match(/(\d+)(\D+)/)[1],d=s[1].match(/(\d+)(\D+)/)[1],g=s[2].match(/(\d+)(\D+)/)[1],f=s[0].match(/(\d+)(\D+)/)[2];a=e("{0}{1}",u-g,f),o=e("{0}{1}",d-g,f),i=e("{0}{1}",2*g,f),n=e("{0}{1}",2*g,f),c="<circle cx='50%' cy='50%' r='50%' />";break;case"ellipse":var u=s[0].match(/(\d+)(\D+)/)[1],d=s[1].match(/(\d+)(\D+)/)[1],p=s[2].match(/(\d+)(\D+)/)[1],h=s[3].match(/(\d+)(\D+)/)[1],f=s[0].match(/(\d+)(\D+)/)[2];a=e("{0}{1}",u-p,f),o=e("{0}{1}",d-h,f),i=e("{0}{1}",2*p,f),n=e("{0}{1}",2*h,f),c="<ellipse cx='50%' cy='50%' rx='50%' ry='50%' />";break;case"polygon":a=o=i=n=0;var v=s[0].search(/nonzero|evenodd/i)>=0?s.shift():"nonzero",y=s.map(function(e){return e=e.replace(/\s+/,","),e=e.replace(/(-?\d+(?:\.\d+)?)(px|%)/g,function(e,t,l,s){var c=parseFloat(t);switch(l){case"%":c*=(s?r.offsetHeight:r.offsetWidth)/100;case"px":default:}return s?(o>c&&(o=c),c>n&&(n=c)):(a>c&&(a=c),c>i&&(i=c)),""+c})});n-=o,i-=a,y.forEach(function(e,t,r){e=e.replace(/(-?\d+(?:\.\d+)?)/g,function(e,t,r){var i=parseFloat(t);return i-=r?o:a,""+i}),r[t]=e}),a+="px",o+="px",i+="px",n+="px",y=y.join(" "),c=e("<polygon fill-rule='{0}' points='{1}' />",v,y);break;default:}var m=document.createElement("div");m.setAttribute("class","shape-bookmarklet-overlay"),m.setAttribute("style",e("width:{0};height:{1};position:absolute;top:{2};left:{3};opacity:0.5",i,n,o,a)),m.innerHTML="<svg xmlns='http://www.w3.org/2000/svg' style='display:block' width='100%' height='100%'><g fill='blue'>"+c+"</g></svg>",r.appendChild(m)}function o(e,t,r){"static"==t.getPropertyValue("position")&&e.style.setProperty("position","relative"),e.style.setProperty("overflow","visible"),a(r,e,t)}function i(){for(var e=document.getElementsByTagName("*"),t=0;e.length>t;t++){var a=e[t],i=getComputedStyle(a);if(!i)return;var n=i.getPropertyValue("-webkit-shape-inside");"outside-shape"==n&&(n=i.getPropertyValue("-webkit-shape-outside")),"auto"!=n&&r(a,i,n);var l=i.getPropertyValue("-webkit-shape-outside");"auto"!=l&&o(a,i,l)}}function n(){i(),s=!0}function l(){for(var e=document.getElementsByClassName("shape-bookmarklet-overlay");e.length;){var t=e[0];t.parentNode.removeChild(t)}s=!1}var s=!1;!function(){window.showShapesBookmarklet=function(){s?l():n()},n()}()})();